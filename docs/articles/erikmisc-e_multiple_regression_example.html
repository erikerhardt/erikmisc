<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Multiple regression using erikmisc • erikmisc</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Multiple regression using erikmisc">
<meta property="og:description" content="erikmisc">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">erikmisc</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.17</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/erikmisc-e_lm_bestsubset.html">Best subset selection</a>
    </li>
    <li>
      <a href="../articles/erikmisc-e_model_all_subsets_formula.html">All model subsets</a>
    </li>
    <li>
      <a href="../articles/erikmisc-e_multiple_regression_example.html">Multiple regression using erikmisc</a>
    </li>
    <li>
      <a href="../articles/erikmisc-e_plot_model_contrasts.html">Plot model contrasts</a>
    </li>
    <li>
      <a href="../articles/erikmisc-e_read_data_subdir_into_lists.html">Read data from subdirectories into a structured list</a>
    </li>
    <li>
      <a href="../articles/erikmisc-e_rmd_name_chunks.html">Rmd/Rnw rename code chunks vignette</a>
    </li>
    <li>
      <a href="../articles/erikmisc-key_variables_completion.html">Key variables completion</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/erikerhardt/erikmisc/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Multiple regression using erikmisc</h1>
            <h3 data-toc-skip class="subtitle">Plotting all linear model
effects and contrasts</h3>
            
      
      <small class="dont-index">Source: <a href="https://github.com/erikerhardt/erikmisc/blob/HEAD/vignettes/erikmisc-e_multiple_regression_example.Rmd" class="external-link"><code>vignettes/erikmisc-e_multiple_regression_example.Rmd</code></a></small>
      <div class="hidden name"><code>erikmisc-e_multiple_regression_example.Rmd</code></div>

    </div>

    
    
<ul>
<li>This is an example of multiple regression using the functions in the
<code>erikmisc</code> package.</li>
</ul>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">knitr</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/knitr/man/opts_chunk.html" class="external-link">opts_chunk</a></span><span class="op">$</span><span class="fu">set</span><span class="op">(</span>fig.width <span class="op">=</span> <span class="fl">6</span>, fig.height <span class="op">=</span> <span class="fl">6</span><span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/erikerhardt/erikmisc" class="external-link">erikmisc</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: replacing previous import 'tidyr::extract' by 'magrittr::extract' when</span></span>
<span><span class="co">#&gt; loading 'erikmisc'</span></span>
<span><span class="co">#&gt; ── <span style="font-weight: bold;">Attaching packages</span> ─────────────────────────────────────── erikmisc 0.1.17 ──</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">tibble</span> 3.1.8      <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">dplyr </span> 1.0.10</span></span>
<span><span class="co">#&gt; ── <span style="font-weight: bold;">Conflicts</span> ─────────────────────────────────────────── erikmisc_conflicts() ──</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">✖</span> <span style="color: #0000BB;">dplyr</span>::<span style="color: #00BB00;">filter()</span> masks <span style="color: #0000BB;">stats</span>::filter()</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">✖</span> <span style="color: #0000BB;">dplyr</span>::<span style="color: #00BB00;">lag()</span>    masks <span style="color: #0000BB;">stats</span>::lag()</span></span>
<span><span class="co">#&gt; erikmisc, solving common complex data analysis workflows</span></span>
<span><span class="co">#&gt;   by Dr. Erik Barry Erhardt &lt;erik@StatAcumen.com&gt;</span></span></code></pre></div>
<div class="section level2">
<h2 id="load-data">Load data<a class="anchor" aria-label="anchor" href="#load-data"></a>
</h2>
<ul>
<li>Calculating <code>mpg_log2</code> and dropping two extremely
influential observations.</li>
<li>Creating some missing values to illustrate missing values plot.</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">dat_mtcars_e</span><span class="op">)</span></span>
<span><span class="va">dat_mtcars_e</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">dat_mtcars_e</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    mpg_log2 <span class="op">=</span> <span class="va">mpg</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log2</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice</a></span><span class="op">(</span></span>
<span>    <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">29</span>, <span class="fl">31</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span></span>
<span>    <span class="va">model</span>, <span class="va">mpg</span>, <span class="va">mpg_log2</span></span>
<span>  , <span class="fu">tidyselect</span><span class="fu">::</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html" class="external-link">everything</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># create some missing values in variable we won't use in the regression model</span></span>
<span><span class="va">var_missing</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"qsec"</span>, <span class="st">"carb"</span>, <span class="st">"am"</span><span class="op">)</span></span>
<span><span class="va">prop_missing</span> <span class="op">=</span> <span class="fl">0.25</span></span>
<span><span class="va">n_missing</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample.int</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">dat_mtcars_e</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">var_missing</span><span class="op">)</span>, size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span> <span class="va">prop_missing</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">dat_mtcars_e</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">var_missing</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">ind_missing</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">dat_mtcars_e</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">var_missing</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="va">n_missing</span>, <span class="op">]</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i_row</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">ind_missing</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">dat_mtcars_e</span><span class="op">[</span><span class="va">ind_missing</span><span class="op">[</span><span class="va">i_row</span>,<span class="fl">1</span><span class="op">]</span>, <span class="va">var_missing</span><span class="op">[</span><span class="va">ind_missing</span><span class="op">[</span><span class="va">i_row</span>,<span class="fl">2</span><span class="op">]</span><span class="op">]</span> <span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">dat_mtcars_e</span><span class="op">)</span></span>
<span><span class="co">#&gt; tibble [30 × 13] (S3: tbl_df/tbl/data.frame)</span></span>
<span><span class="co">#&gt;  $ model   : chr [1:30] "Mazda RX4" "Mazda RX4 Wag" "Datsun 710" "Hornet 4 Drive" ...</span></span>
<span><span class="co">#&gt;   ..- attr(*, "label")= chr "Model"</span></span>
<span><span class="co">#&gt;  $ mpg     : num [1:30] 21 21 22.8 21.4 18.7 18.1 14.3 24.4 22.8 19.2 ...</span></span>
<span><span class="co">#&gt;   ..- attr(*, "label")= chr "Miles/(US) gallon"</span></span>
<span><span class="co">#&gt;  $ mpg_log2: num [1:30] 4.39 4.39 4.51 4.42 4.22 ...</span></span>
<span><span class="co">#&gt;   ..- attr(*, "label")= chr "Miles/(US) gallon"</span></span>
<span><span class="co">#&gt;  $ cyl     : Factor w/ 3 levels "four","six","eight": 2 2 1 2 3 2 3 1 1 2 ...</span></span>
<span><span class="co">#&gt;   ..- attr(*, "label")= chr "Number of cylinders"</span></span>
<span><span class="co">#&gt;  $ disp    : num [1:30] 160 160 108 258 360 ...</span></span>
<span><span class="co">#&gt;   ..- attr(*, "label")= chr "Displacement (cu.in.)"</span></span>
<span><span class="co">#&gt;  $ hp      : num [1:30] 110 110 93 110 175 105 245 62 95 123 ...</span></span>
<span><span class="co">#&gt;   ..- attr(*, "label")= chr "Gross horsepower"</span></span>
<span><span class="co">#&gt;  $ drat    : num [1:30] 3.9 3.9 3.85 3.08 3.15 2.76 3.21 3.69 3.92 3.92 ...</span></span>
<span><span class="co">#&gt;   ..- attr(*, "label")= chr "Rear axle ratio"</span></span>
<span><span class="co">#&gt;  $ wt      : num [1:30] 2.62 2.88 2.32 3.21 3.44 ...</span></span>
<span><span class="co">#&gt;   ..- attr(*, "label")= chr "Weight (1000 lbs)"</span></span>
<span><span class="co">#&gt;  $ qsec    : num [1:30] 16.5 17 18.6 NA 17 ...</span></span>
<span><span class="co">#&gt;   ..- attr(*, "label")= chr "1/4 mile time"</span></span>
<span><span class="co">#&gt;  $ vs      : Factor w/ 2 levels "V-shaped","straight": 1 1 2 2 1 2 1 2 2 2 ...</span></span>
<span><span class="co">#&gt;   ..- attr(*, "label")= chr "Engine"</span></span>
<span><span class="co">#&gt;  $ am      : Factor w/ 2 levels "automatic","manual": 2 2 2 1 NA 1 1 1 1 1 ...</span></span>
<span><span class="co">#&gt;   ..- attr(*, "label")= chr "Transmission"</span></span>
<span><span class="co">#&gt;  $ gear    : num [1:30] 4 4 4 3 3 3 3 4 4 4 ...</span></span>
<span><span class="co">#&gt;   ..- attr(*, "label")= chr "Number of forward gears"</span></span>
<span><span class="co">#&gt;  $ carb    : num [1:30] 4 4 NA 1 NA 1 NA 2 2 NA ...</span></span>
<span><span class="co">#&gt;   ..- attr(*, "label")= chr "Number of carburetors"</span></span>
<span><span class="co">#summary(dat_mtcars_e)</span></span></code></pre></div>
<div class="section level3">
<h3 id="plot-missing-values">Plot missing values<a class="anchor" aria-label="anchor" href="#plot-missing-values"></a>
</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/e_plot_missing.html">e_plot_missing</a></span><span class="op">(</span></span>
<span>    dat_plot       <span class="op">=</span> <span class="va">dat_mtcars_e</span></span>
<span>  , var_group      <span class="op">=</span> <span class="st">"cyl"</span></span>
<span>  , sw_group_sort  <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  , var2_sort      <span class="op">=</span> <span class="st">"disp"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Using alpha for a discrete variable is not advised.</span></span></code></pre></div>
<p><img src="erikmisc-e_multiple_regression_example_files/figure-html/unnamed-chunk-3-1.png" width="576"></p>
</div>
</div>
<div class="section level2">
<h2 id="fit-full-model">Fit full model<a class="anchor" aria-label="anchor" href="#fit-full-model"></a>
</h2>
<ul>
<li>This model is chosen to have numeric and categorical main effects,
and at least two of possible types of two-way interaction (cat:cat,
cat:num, num:num).</li>
</ul>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span> <span class="co"># Set model with all two-way interactions</span></span>
<span><span class="co">#form_model &lt;-</span></span>
<span><span class="co">#  mpg ~ (cyl + disp + hp + wt + vs + am + gear)^2</span></span>
<span><span class="co">#form_model &lt;-</span></span>
<span><span class="co">#  mpg ~ (cyl + disp + hp + wt + am)^2</span></span>
<span><span class="va">form_model</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">mpg_log2</span> <span class="op">~</span> <span class="op">(</span><span class="va">cyl</span> <span class="op">+</span> <span class="va">disp</span> <span class="op">+</span> <span class="va">hp</span> <span class="op">+</span> <span class="va">wt</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span></span>
<span></span>
<span><span class="co"># fit model</span></span>
<span><span class="va">lm_fit</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span></span>
<span>    formula <span class="op">=</span> <span class="va">form_model</span></span>
<span>  , data    <span class="op">=</span> <span class="va">dat_mtcars_e</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<ul>
<li>Anova shows of the many two-way interactions in the model, almost
none are significant.</li>
<li>We can greatly simplify this model.</li>
</ul>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">car</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/car/man/Anova.html" class="external-link">Anova</a></span><span class="op">(</span><span class="va">lm_fit</span>, type <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt; Anova Table (Type III tests)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Response: mpg_log2</span></span>
<span><span class="co">#&gt;              Sum Sq Df F value    Pr(&gt;F)    </span></span>
<span><span class="co">#&gt; (Intercept) 0.84118  1 27.6210 9.691e-05 ***</span></span>
<span><span class="co">#&gt; cyl         0.12606  2  2.0697    0.1608    </span></span>
<span><span class="co">#&gt; disp        0.03640  1  1.1953    0.2915    </span></span>
<span><span class="co">#&gt; hp          0.01336  1  0.4386    0.5179    </span></span>
<span><span class="co">#&gt; wt          0.00343  1  0.1126    0.7418    </span></span>
<span><span class="co">#&gt; cyl:disp    0.04539  2  0.7453    0.4914    </span></span>
<span><span class="co">#&gt; cyl:hp      0.03503  2  0.5751    0.5746    </span></span>
<span><span class="co">#&gt; cyl:wt      0.04699  2  0.7715    0.4798    </span></span>
<span><span class="co">#&gt; disp:hp     0.00040  1  0.0132    0.9100    </span></span>
<span><span class="co">#&gt; disp:wt     0.07565  1  2.4840    0.1359    </span></span>
<span><span class="co">#&gt; hp:wt       0.00051  1  0.0168    0.8985    </span></span>
<span><span class="co">#&gt; Residuals   0.45681 15                      </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre></div>
<ul>
<li>Summary shows that all effects were estimable.</li>
</ul>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">lm_fit</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = form_model, data = dat_mtcars_e)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;      Min       1Q   Median       3Q      Max </span></span>
<span><span class="co">#&gt; -0.20361 -0.08321 -0.03319  0.09897  0.28179 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;                 Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)    4.669e+00  8.883e-01   5.256 9.69e-05 ***</span></span>
<span><span class="co">#&gt; cylsix        -2.131e+00  1.271e+00  -1.676   0.1144    </span></span>
<span><span class="co">#&gt; cyleight      -7.621e+00  4.189e+00  -1.819   0.0889 .  </span></span>
<span><span class="co">#&gt; disp           1.052e-02  9.626e-03   1.093   0.2915    </span></span>
<span><span class="co">#&gt; hp            -5.938e-03  8.966e-03  -0.662   0.5179    </span></span>
<span><span class="co">#&gt; wt             2.620e-01  7.808e-01   0.336   0.7418    </span></span>
<span><span class="co">#&gt; cylsix:disp    7.506e-03  6.170e-03   1.217   0.2425    </span></span>
<span><span class="co">#&gt; cyleight:disp  1.145e-02  1.169e-02   0.980   0.3428    </span></span>
<span><span class="co">#&gt; cylsix:hp      5.487e-03  5.235e-03   1.048   0.3112    </span></span>
<span><span class="co">#&gt; cyleight:hp    4.664e-03  2.328e-02   0.200   0.8439    </span></span>
<span><span class="co">#&gt; cylsix:wt      1.377e-01  4.121e-01   0.334   0.7430    </span></span>
<span><span class="co">#&gt; cyleight:wt    1.369e+00  1.285e+00   1.066   0.3033    </span></span>
<span><span class="co">#&gt; disp:hp       -1.432e-05  1.246e-04  -0.115   0.9100    </span></span>
<span><span class="co">#&gt; disp:wt       -4.697e-03  2.980e-03  -1.576   0.1359    </span></span>
<span><span class="co">#&gt; hp:wt          7.731e-04  5.959e-03   0.130   0.8985    </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 0.1745 on 15 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.9169, Adjusted R-squared:  0.8393 </span></span>
<span><span class="co">#&gt; F-statistic: 11.82 on 14 and 15 DF,  p-value: 1.144e-05</span></span></code></pre></div>
<div class="section level3">
<h3 id="assess-model-assumptions">Assess model assumptions<a class="anchor" aria-label="anchor" href="#assess-model-assumptions"></a>
</h3>
<ul>
<li>On full dataset:
<ul>
<li>QQ-plot shows roughly normal (outliers in the direction of high
kurtosis, “leptokurtosis”).</li>
<li>Cook’s distance shows two highly influential observations.</li>
<li>Cook’s vs leverage plot shows that these influential observations
(y-axis) are because of their high leverage (outlier in the
x-direction).</li>
<li>Box-Cox suggests a lambda = 0, log(y) transformation will improve
normality.</li>
</ul>
</li>
<li>After log2 transform and dropping two extremely influential
observations (below)…
<ul>
<li>Cook’s distance shows two or three influential observations.</li>
</ul>
</li>
</ul>
<p><em>Recall, our goal is not to resolve all issues, but to illustrate
the functions in the <code>erikmisc</code> package.</em></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/e_plot_lm_diagostics.html">e_plot_lm_diagostics</a></span><span class="op">(</span></span>
<span>    fit <span class="op">=</span> <span class="va">lm_fit</span></span>
<span>  , sw_plot_set <span class="op">=</span> <span class="st">"simple"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="erikmisc-e_multiple_regression_example_files/figure-html/unnamed-chunk-7-1.png" width="768"><img src="erikmisc-e_multiple_regression_example_files/figure-html/unnamed-chunk-7-2.png" width="768"><img src="erikmisc-e_multiple_regression_example_files/figure-html/unnamed-chunk-7-3.png" width="768"></p>
</div>
</div>
<div class="section level2">
<h2 id="best-subset-selection">Best subset selection<a class="anchor" aria-label="anchor" href="#best-subset-selection"></a>
</h2>
<ul>
<li>The best model by BIC has <code>hp</code> and <code>wt</code>.</li>
</ul>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tab_lm_best</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/e_lm_bestsubset.html">e_lm_bestsubset</a></span><span class="op">(</span></span>
<span>    form  <span class="op">=</span> <span class="va">form_model</span></span>
<span>  , dat   <span class="op">=</span> <span class="va">dat_mtcars_e</span></span>
<span>  , nbest <span class="op">=</span> <span class="fl">4</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span>  <span class="co">### consider these options if you temporarily need a wider output in your Rmd output</span></span>
<span>  <span class="va">op</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span><span class="op">)</span>; <span class="co"># saving old options</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">200</span><span class="op">)</span> <span class="co"># setting command window output text width wider</span></span>
<span><span class="va">tab_lm_best</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span>n <span class="op">=</span> <span class="cn">Inf</span>, width <span class="op">=</span> <span class="cn">Inf</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 53 × 21</span></span></span>
<span><span class="co">#&gt;    `(Intercept)` cylsix cyleight  disp    hp    wt `cylsix:disp` `cyleight:disp` `cylsix:hp` `cyleight:hp` `cylsix:wt` `cyleight:wt` `disp:hp` `disp:wt` `hp:wt`  SIZE   rss    r2 adjr2     cp   bic</span></span>
<span><span class="co">#&gt;            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>             1      0        0     0     1     1             0               0           0             0           0             0         0         0       0     2 0.704 0.872 0.862 -<span style="color: #BB0000;">0.882</span> -<span style="color: #BB0000;">51.4</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>             1      0        0     0     1     1             0               0           0             0           0             0         0         0       1     3 0.644 0.883 0.869 -<span style="color: #BB0000;">0.850</span> -<span style="color: #BB0000;">50.7</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>             1      0        0     0     1     1             0               0           0             0           1             0         0         0       0     3 0.677 0.877 0.863  0.234 -<span style="color: #BB0000;">49.2</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>             1      1        0     0     1     1             0               0           0             0           0             0         0         0       0     3 0.677 0.877 0.863  0.239 -<span style="color: #BB0000;">49.2</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>             1      0        0     0     1     1             1               0           0             0           0             0         0         0       0     3 0.681 0.876 0.862  0.373 -<span style="color: #BB0000;">49.0</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>             1      0        0     0     1     1             0               0           0             0           0             0         0         1       1     4 0.638 0.884 0.865  0.947 -<span style="color: #BB0000;">47.6</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>             1      0        0     1     1     1             0               0           0             0           0             0         1         0       0     4 0.640 0.884 0.865  1.02  -<span style="color: #BB0000;">47.5</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>             1      1        0     0     1     1             0               0           0             0           0             0         0         0       1     4 0.641 0.883 0.865  1.05  -<span style="color: #BB0000;">47.5</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>             1      0        0     0     1     1             0               0           0             0           1             0         0         0       1     4 0.641 0.883 0.865  1.05  -<span style="color: #BB0000;">47.5</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>             1      0        0     0     0     1             0               0           0             0           0             0         0         0       1     2 0.854 0.845 0.833  4.03  -<span style="color: #BB0000;">45.7</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span>             1      0        0     0     0     1             0               0           0             0           0             0         1         0       0     2 0.874 0.841 0.829  4.70  -<span style="color: #BB0000;">45.0</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span>             1      0        0     0     1     1             0               0           0             0           0             0         1         1       1     5 0.628 0.886 0.862  2.63  -<span style="color: #BB0000;">44.7</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span>             1      0        0     0     0     1             0               0           0             1           0             0         0         0       0     2 0.883 0.839 0.827  5.00  -<span style="color: #BB0000;">44.6</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">14</span>             1      0        0     1     1     1             0               0           0             0           0             0         0         1       1     5 0.629 0.886 0.862  2.65  -<span style="color: #BB0000;">44.6</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">15</span>             1      1        0     0     1     1             0               0           1             0           0             0         0         0       1     5 0.632 0.885 0.861  2.76  -<span style="color: #BB0000;">44.5</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">16</span>             1      1        0     0     1     1             0               0           0             0           0             0         0         1       1     5 0.633 0.885 0.861  2.77  -<span style="color: #BB0000;">44.5</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">17</span>             1      0        0     0     0     1             0               0           0             0           0             0         0         0       0     1 1.01  0.817 0.810  7.09  -<span style="color: #BB0000;">44.1</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">18</span>             1      0        0     0     0     0             0               0           0             0           0             0         0         0       1     1 1.05  0.808 0.801  8.60  -<span style="color: #BB0000;">42.8</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">19</span>             1      0        0     0     1     0             0               1           0             1           0             1         1         1       0     6 0.604 0.890 0.862  3.82  -<span style="color: #BB0000;">42.5</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">20</span>             1      0        1     1     1     0             0               0           0             0           0             1         1         1       0     6 0.609 0.889 0.860  3.99  -<span style="color: #BB0000;">42.2</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">21</span>             1      0        1     0     1     0             0               0           0             1           0             1         1         1       0     6 0.611 0.889 0.860  4.05  -<span style="color: #BB0000;">42.1</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">22</span>             1      1        1     0     1     0             1               1           0             0           0             1         0         1       0     7 0.547 0.901 0.869  3.95  -<span style="color: #BB0000;">42.0</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">23</span>             1      0        1     1     1     0             0               1           0             0           0             1         0         1       0     6 0.616 0.888 0.859  4.22  -<span style="color: #BB0000;">41.9</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">24</span>             1      1        1     0     0     0             1               1           0             0           0             1         1         1       0     7 0.567 0.897 0.864  4.61  -<span style="color: #BB0000;">40.9</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">25</span>             1      1        1     0     0     0             1               1           0             0           0             1         0         1       1     7 0.570 0.896 0.863  4.71  -<span style="color: #BB0000;">40.8</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">26</span>             1      0        1     0     1     0             1               1           0             0           1             1         0         1       0     7 0.575 0.895 0.862  4.87  -<span style="color: #BB0000;">40.5</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">27</span>             1      1        1     0     0     1             1               1           0             0           0             1         0         1       1     8 0.526 0.904 0.868  5.27  -<span style="color: #BB0000;">39.8</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">28</span>             1      1        1     0     1     1             1               1           0             0           0             1         0         1       0     8 0.527 0.904 0.868  5.31  -<span style="color: #BB0000;">39.7</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">29</span>             1      1        1     0     1     0             1               1           1             0           0             1         0         1       0     8 0.536 0.902 0.865  5.60  -<span style="color: #BB0000;">39.2</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">30</span>             1      1        1     1     1     0             1               1           0             0           0             1         0         1       0     8 0.537 0.902 0.865  5.64  -<span style="color: #BB0000;">39.2</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">31</span>             1      1        1     1     1     1             1               1           0             0           0             1         0         1       0     9 0.496 0.910 0.869  6.27  -<span style="color: #BB0000;">38.2</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">32</span>             1      1        1     1     0     1             1               1           0             0           0             1         0         1       1     9 0.507 0.908 0.866  6.65  -<span style="color: #BB0000;">37.5</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">33</span>             1      0        0     1     0     0             0               0           0             0           0             0         0         0       0     1 1.26  0.771 0.763 15.3   -<span style="color: #BB0000;">37.4</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">34</span>             1      1        1     1     1     0             1               1           0             0           0             1         0         1       1     9 0.514 0.907 0.864  6.87  -<span style="color: #BB0000;">37.1</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">35</span>             1      1        1     0     1     1             1               1           1             0           0             1         0         1       0     9 0.514 0.906 0.864  6.89  -<span style="color: #BB0000;">37.1</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">36</span>             1      1        1     1     1     1             1               1           1             0           0             1         0         1       0    10 0.473 0.914 0.869  7.52  -<span style="color: #BB0000;">36.2</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">37</span>             1      1        1     1     1     0             1               1           1             0           0             1         0         1       1    10 0.481 0.912 0.866  7.81  -<span style="color: #BB0000;">35.6</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">38</span>             1      0        0     0     0     0             0               0           0             0           0             0         0         1       0     1 1.35  0.754 0.745 18.5   -<span style="color: #BB0000;">35.2</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">39</span>             1      1        1     1     1     1             1               1           0             0           0             1         0         1       1    10 0.495 0.910 0.863  8.24  -<span style="color: #BB0000;">34.8</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">40</span>             1      1        1     1     0     1             1               1           1             0           0             1         0         1       1    10 0.495 0.910 0.863  8.25  -<span style="color: #BB0000;">34.8</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">41</span>             1      1        1     1     1     1             1               1           1             1           0             1         0         1       0    11 0.465 0.915 0.864  9.26  -<span style="color: #BB0000;">33.3</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">42</span>             1      1        1     1     1     1             1               1           1             0           0             1         0         1       1    11 0.466 0.915 0.863  9.30  -<span style="color: #BB0000;">33.2</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">43</span>             1      1        1     1     1     1             1               1           1             0           0             1         1         1       0    11 0.466 0.915 0.863  9.31  -<span style="color: #BB0000;">33.2</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">44</span>             1      1        1     1     1     1             1               1           1             0           1             1         0         1       0    11 0.469 0.915 0.862  9.40  -<span style="color: #BB0000;">33.0</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">45</span>             1      1        1     1     1     1             1               1           1             1           1             1         0         1       0    12 0.457 0.917 0.858 11.0   -<span style="color: #BB0000;">30.4</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">46</span>             1      1        1     1     1     1             1               1           1             0           1             1         1         1       0    12 0.458 0.917 0.858 11.0   -<span style="color: #BB0000;">30.3</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">47</span>             1      1        1     1     1     1             1               1           1             0           1             1         0         1       1    12 0.461 0.916 0.857 11.1   -<span style="color: #BB0000;">30.1</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">48</span>             1      1        1     1     1     0             1               1           1             1           0             1         1         1       1    12 0.461 0.916 0.857 11.2   -<span style="color: #BB0000;">30.1</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">49</span>             1      1        1     1     1     1             1               1           1             1           1             1         0         1       1    13 0.457 0.917 0.849 13.0   -<span style="color: #BB0000;">27.0</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">50</span>             1      1        1     1     1     1             1               1           1             1           1             1         1         1       0    13 0.457 0.917 0.849 13.0   -<span style="color: #BB0000;">27.0</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">51</span>             1      1        1     1     1     1             1               1           1             0           1             1         1         1       1    13 0.458 0.917 0.849 13.0   -<span style="color: #BB0000;">26.9</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">52</span>             1      1        1     1     1     1             1               1           1             1           0             1         1         1       1    13 0.460 0.916 0.848 13.1   -<span style="color: #BB0000;">26.8</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">53</span>             1      1        1     1     1     1             1               1           1             1           1             1         1         1       1    14 0.457 0.917 0.839 15     -<span style="color: #BB0000;">23.6</span></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span><span class="va">op</span><span class="op">)</span>; <span class="co"># reset (all) initial options</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="fit-reduced-model">Fit reduced model<a class="anchor" aria-label="anchor" href="#fit-reduced-model"></a>
</h2>
<ul>
<li>For demonstration purposes, I’m choosing Model 9 because it has both
<code>factor:numeric</code> and <code>numeric:numeric</code>
interactions.</li>
</ul>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tab_lm_best</span><span class="op">[</span><span class="fl">9</span>, <span class="op">]</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span>width <span class="op">=</span> <span class="cn">Inf</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 × 21</span></span></span>
<span><span class="co">#&gt;   `(Intercept)` cylsix cyleight  disp    hp    wt `cylsix:disp` `cyleight:disp`</span></span>
<span><span class="co">#&gt;           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>             1      0        0     0     1     1             0               0</span></span>
<span><span class="co">#&gt;   `cylsix:hp` `cyleight:hp` `cylsix:wt` `cyleight:wt` `disp:hp` `disp:wt`</span></span>
<span><span class="co">#&gt;         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>           0             0           1             0         0         0</span></span>
<span><span class="co">#&gt;   `hp:wt`  SIZE   rss    r2 adjr2    cp   bic</span></span>
<span><span class="co">#&gt;     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>       1     4 0.641 0.883 0.865  1.05 -<span style="color: #BB0000;">47.5</span></span></span>
<span></span>
<span><span class="va">form_model_red</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">mpg_log2</span> <span class="op">~</span> <span class="va">cyl</span> <span class="op">+</span> <span class="va">hp</span> <span class="op">+</span> <span class="va">wt</span> <span class="op">+</span> <span class="va">cyl</span><span class="op">:</span><span class="va">wt</span> <span class="op">+</span> <span class="va">hp</span><span class="op">:</span><span class="va">wt</span></span>
<span></span>
<span><span class="co"># fit reduced model</span></span>
<span><span class="va">lm_fit_red</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span></span>
<span>    formula <span class="op">=</span> <span class="va">form_model_red</span></span>
<span>  , data    <span class="op">=</span> <span class="va">dat_mtcars_e</span></span>
<span>  <span class="op">)</span></span>
<span><span class="fu">car</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/car/man/Anova.html" class="external-link">Anova</a></span><span class="op">(</span><span class="va">lm_fit_red</span>, type <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt; Anova Table (Type III tests)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Response: mpg_log2</span></span>
<span><span class="co">#&gt;             Sum Sq Df  F value    Pr(&gt;F)    </span></span>
<span><span class="co">#&gt; (Intercept) 4.5934  1 160.0266 1.434e-11 ***</span></span>
<span><span class="co">#&gt; cyl         0.0020  2   0.0346   0.96604    </span></span>
<span><span class="co">#&gt; hp          0.0396  1   1.3779   0.25300    </span></span>
<span><span class="co">#&gt; wt          0.1673  1   5.8301   0.02452 *  </span></span>
<span><span class="co">#&gt; cyl:wt      0.0033  2   0.0580   0.94378    </span></span>
<span><span class="co">#&gt; hp:wt       0.0144  1   0.5031   0.48561    </span></span>
<span><span class="co">#&gt; Residuals   0.6315 22                       </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">lm_fit_red</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = form_model_red, data = dat_mtcars_e)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;      Min       1Q   Median       3Q      Max </span></span>
<span><span class="co">#&gt; -0.21433 -0.11248 -0.04022  0.11759  0.30703 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;              Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)  5.876799   0.464563  12.650 1.43e-11 ***</span></span>
<span><span class="co">#&gt; cylsix      -0.002383   0.705472  -0.003   0.9973    </span></span>
<span><span class="co">#&gt; cyleight     0.206482   0.860573   0.240   0.8126    </span></span>
<span><span class="co">#&gt; hp          -0.006188   0.005272  -1.174   0.2530    </span></span>
<span><span class="co">#&gt; wt          -0.379670   0.157242  -2.415   0.0245 *  </span></span>
<span><span class="co">#&gt; cylsix:wt   -0.023409   0.231137  -0.101   0.9202    </span></span>
<span><span class="co">#&gt; cyleight:wt -0.090373   0.267916  -0.337   0.7391    </span></span>
<span><span class="co">#&gt; hp:wt        0.001158   0.001632   0.709   0.4856    </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 0.1694 on 22 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.8851, Adjusted R-squared:  0.8486 </span></span>
<span><span class="co">#&gt; F-statistic: 24.21 on 7 and 22 DF,  p-value: 6.067e-09</span></span></code></pre></div>
<div class="section level3">
<h3 id="assess-model-assumptions-1">Assess model assumptions<a class="anchor" aria-label="anchor" href="#assess-model-assumptions-1"></a>
</h3>
<ul>
<li>Cook’s distance shows Observation 17 is influential.</li>
</ul>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/e_plot_lm_diagostics.html">e_plot_lm_diagostics</a></span><span class="op">(</span></span>
<span>    fit <span class="op">=</span> <span class="va">lm_fit_red</span></span>
<span>  , sw_plot_set <span class="op">=</span> <span class="st">"simpleAV"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="erikmisc-e_multiple_regression_example_files/figure-html/unnamed-chunk-10-1.png" width="768"><img src="erikmisc-e_multiple_regression_example_files/figure-html/unnamed-chunk-10-2.png" width="768"><img src="erikmisc-e_multiple_regression_example_files/figure-html/unnamed-chunk-10-3.png" width="768"><img src="erikmisc-e_multiple_regression_example_files/figure-html/unnamed-chunk-10-4.png" width="768"><img src="erikmisc-e_multiple_regression_example_files/figure-html/unnamed-chunk-10-5.png" width="768"></p>
</div>
</div>
<div class="section level2">
<h2 id="plot-model-contrasts">Plot model contrasts<a class="anchor" aria-label="anchor" href="#plot-model-contrasts"></a>
</h2>
<ul>
<li>See the help <code><a href="../reference/e_plot_model_contrasts.html">?e_plot_model_contrasts</a></code> for the method
defaults.</li>
<li>I’m choosing to not print the output (default) while the function
runs so that we can examine the separate lists in the output.</li>
</ul>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lm_fit_contrasts</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/e_plot_model_contrasts.html">e_plot_model_contrasts</a></span><span class="op">(</span></span>
<span>    fit                 <span class="op">=</span> <span class="va">lm_fit_red</span></span>
<span>  , dat_cont            <span class="op">=</span> <span class="va">dat_mtcars_e</span></span>
<span>  , adjust_method       <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"none"</span>, <span class="st">"tukey"</span>, <span class="st">"scheffe"</span>, <span class="st">"sidak"</span>, <span class="st">"bonferroni"</span>, <span class="st">"dunnettx"</span>, <span class="st">"mvt"</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span>
<span>  , sw_print            <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  , sw_TWI_plots_keep   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"singles"</span>, <span class="st">"both"</span>, <span class="st">"all"</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; e_plot_model_contrasts: Skipping "cyl" since involved in interactions.</span></span>
<span><span class="co">#&gt; e_plot_model_contrasts: Skipping "hp" since involved in interactions.</span></span>
<span><span class="co">#&gt; e_plot_model_contrasts: Skipping "wt" since involved in interactions.</span></span>
<span><span class="co">#&gt; I bet you wanted to call this with just object[[1]] - use '[[]]' or which' if I'm wrong.</span></span>
<span><span class="co">#&gt; See '? emm_list' for more information</span></span></code></pre></div>
<ul>
<li>The output contains lists for tables, plots, and text.</li>
</ul>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lm_fit_contrasts</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "tables" "plots"  "text"</span></span></code></pre></div>
<div class="section level3">
<h3 id="tables">tables<a class="anchor" aria-label="anchor" href="#tables"></a>
</h3>
<ul>
<li>The <code>tables</code> are give the estimates (<code>$est</code>)
and contrasts (<code>$cont</code>) for each effect in the model not
involved with an interaction (argument
<code>sw_marginal_even_if_interaction</code> can include all main
effects).</li>
</ul>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># to print tables</span></span>
<span><span class="va">lm_fit_contrasts</span><span class="op">$</span><span class="va">tables</span></span>
<span><span class="co">#&gt; $`cyl:wt`</span></span>
<span><span class="co">#&gt; $`cyl:wt`$est</span></span>
<span><span class="co">#&gt;  cyl   wt.trend    SE df lower.CL upper.CL</span></span>
<span><span class="co">#&gt;  four    -0.222 0.135 22   -0.502   0.0590</span></span>
<span><span class="co">#&gt;  six     -0.245 0.197 22   -0.654   0.1637</span></span>
<span><span class="co">#&gt;  eight   -0.312 0.161 22   -0.646   0.0215</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Confidence level used: 0.95 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`cyl:wt`$cont</span></span>
<span><span class="co">#&gt;  contrast     estimate    SE df t.ratio p.value</span></span>
<span><span class="co">#&gt;  four - six     0.0234 0.231 22   0.101  0.9944</span></span>
<span><span class="co">#&gt;  four - eight   0.0904 0.268 22   0.337  0.9394</span></span>
<span><span class="co">#&gt;  six - eight    0.0670 0.269 22   0.249  0.9664</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; P value adjustment: tukey method for comparing a family of 3 estimates</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="text">text<a class="anchor" aria-label="anchor" href="#text"></a>
</h3>
<ul>
<li>The <code>text</code> of the tables are written in a form that can
be copy/pasted into a report and worked into sentences.</li>
</ul>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># to print caption text</span></span>
<span><span class="co">#lm_fit_contrasts$text</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="plots">plots<a class="anchor" aria-label="anchor" href="#plots"></a>
</h3>
<ul>
<li>The <code>plots</code> illustrate the effects with labelled plots
and the <code>text</code> in the caption for a single complete
result.</li>
</ul>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># These are the two plots</span></span>
<span><span class="va">lm_fit_contrasts</span><span class="op">$</span><span class="va">plots</span><span class="op">$</span><span class="va">`cyl:wt`</span><span class="op">$</span><span class="va">both</span></span></code></pre></div>
<p><img src="erikmisc-e_multiple_regression_example_files/figure-html/unnamed-chunk-15-1.png" width="768"></p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lm_fit_contrasts</span><span class="op">$</span><span class="va">plots</span><span class="op">$</span><span class="va">`hp:wt`</span><span class="op">$</span><span class="va">both</span></span></code></pre></div>
<p><img src="erikmisc-e_multiple_regression_example_files/figure-html/unnamed-chunk-15-2.png" width="768"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Erik Erhardt.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
