<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Key variables completion â€¢ erikmisc</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Key variables completion">
<meta property="og:description" content="erikmisc">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">erikmisc</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/erikmisc-e_lm_bestsubset.html">Best subset selection</a>
    </li>
    <li>
      <a href="../articles/erikmisc-e_plot_model_contrasts.html">Plot model contrasts</a>
    </li>
    <li>
      <a href="../articles/erikmisc-key_variables_completion.html">Key variables completion</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/erikerhardt/erikmisc/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="erikmisc-key_variables_completion_files/header-attrs-2.10/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Key variables completion</h1>
            <h3 class="subtitle">Efficient completion of keys from multiple data sources</h3>
            
      
      <small class="dont-index">Source: <a href="https://github.com/erikerhardt/erikmisc/blob/master/vignettes/erikmisc-key_variables_completion.Rmd"><code>vignettes/erikmisc-key_variables_completion.Rmd</code></a></small>
      <div class="hidden name"><code>erikmisc-key_variables_completion.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/erikerhardt/erikmisc">erikmisc</a></span><span class="op">)</span>
<span class="co">#&gt; Registered S3 methods overwritten by 'lme4':</span>
<span class="co">#&gt;   method                          from</span>
<span class="co">#&gt;   cooks.distance.influence.merMod car </span>
<span class="co">#&gt;   influence.merMod                car </span>
<span class="co">#&gt;   dfbeta.influence.merMod         car </span>
<span class="co">#&gt;   dfbetas.influence.merMod        car</span>
<span class="co">#&gt; Registered S3 methods overwritten by 'parameters':</span>
<span class="co">#&gt;   method                           from      </span>
<span class="co">#&gt;   as.double.parameters_kurtosis    datawizard</span>
<span class="co">#&gt;   as.double.parameters_skewness    datawizard</span>
<span class="co">#&gt;   as.double.parameters_smoothness  datawizard</span>
<span class="co">#&gt;   as.numeric.parameters_kurtosis   datawizard</span>
<span class="co">#&gt;   as.numeric.parameters_skewness   datawizard</span>
<span class="co">#&gt;   as.numeric.parameters_smoothness datawizard</span>
<span class="co">#&gt;   print.parameters_distribution    datawizard</span>
<span class="co">#&gt;   print.parameters_kurtosis        datawizard</span>
<span class="co">#&gt;   print.parameters_skewness        datawizard</span>
<span class="co">#&gt;   summary.parameters_kurtosis      datawizard</span>
<span class="co">#&gt;   summary.parameters_skewness      datawizard</span>
<span class="co">#&gt; erikmisc, solving common complex data analysis workflows</span>
<span class="co">#&gt;   by Dr. Erik Barry Erhardt &lt;erik@StatAcumen.com&gt;</span></code></pre></div>
<div id="completing-combinations-of-key-variables" class="section level1">
<h1 class="hasAnchor">
<a href="#completing-combinations-of-key-variables" class="anchor"></a>Completing combinations of key variables</h1>
<p>Consider the data below. Let <code>a</code>, <code>b</code>, and <code>c</code> each be unique keys from a variety of data sources, where some data sources contain more than one of the keys, but not necessarily all of them at the same time. The goal is to complete the keys best by cross-referencing all other matching pairs.</p>
<p>For example, <code>a=1</code> and <code>b=11</code> appear together, and <code>a=1</code> and <code>c=10</code> appear together, therefore these three key values should appear together on the first two rows.</p>
<p>Data and best key variables completion.</p>
<p><code>x</code> is a key variable but does not appear in this subset. The function handles empty keys, too.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># with data for key matching imputation</span>
<span class="va">dat_data</span> <span class="op">&lt;-</span>
  <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html">tribble</a></span><span class="op">(</span>
    <span class="op">~</span><span class="va">a</span>, <span class="op">~</span><span class="va">b</span>, <span class="op">~</span><span class="va">c</span>, <span class="op">~</span><span class="va">x</span>, <span class="op">~</span><span class="va">d1</span>, <span class="op">~</span><span class="va">d2</span>
  ,  <span class="fl">1</span>, <span class="fl">11</span>, <span class="cn">NA</span>, <span class="cn">NA</span>,   <span class="fl">1</span>,  <span class="fl">20</span>
  ,  <span class="fl">1</span>, <span class="cn">NA</span>, <span class="fl">10</span>, <span class="cn">NA</span>,   <span class="fl">2</span>,  <span class="fl">21</span>
  ,  <span class="fl">2</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>,   <span class="fl">3</span>,  <span class="fl">22</span>
  , <span class="cn">NA</span>, <span class="fl">22</span>, <span class="fl">20</span>, <span class="cn">NA</span>,   <span class="fl">4</span>,  <span class="fl">23</span>
  ,  <span class="fl">2</span>, <span class="cn">NA</span>, <span class="fl">20</span>, <span class="cn">NA</span>,   <span class="fl">5</span>,  <span class="fl">24</span>
  ,  <span class="fl">3</span>, <span class="fl">33</span>, <span class="cn">NA</span>, <span class="cn">NA</span>,   <span class="fl">6</span>,  <span class="fl">25</span>
  ,  <span class="fl">4</span>, <span class="cn">NA</span>, <span class="fl">40</span>, <span class="cn">NA</span>,   <span class="fl">7</span>,  <span class="fl">26</span>
  ,  <span class="fl">5</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>,   <span class="fl">8</span>,  <span class="fl">27</span>
  ,  <span class="fl">6</span>, <span class="cn">NA</span>, <span class="fl">60</span>, <span class="cn">NA</span>,   <span class="fl">9</span>,  <span class="fl">28</span>
  ,  <span class="fl">6</span>, <span class="cn">NA</span>, <span class="fl">60</span>, <span class="cn">NA</span>,  <span class="fl">10</span>,  <span class="fl">29</span>
  , <span class="cn">NA</span>, <span class="fl">77</span>, <span class="cn">NA</span>, <span class="cn">NA</span>,  <span class="fl">11</span>,  <span class="fl">30</span>
  , <span class="cn">NA</span>, <span class="fl">88</span>, <span class="fl">80</span>, <span class="cn">NA</span>,  <span class="fl">12</span>,  <span class="fl">31</span>
  , <span class="cn">NA</span>, <span class="fl">88</span>, <span class="cn">NA</span>, <span class="cn">NA</span>,  <span class="fl">13</span>,  <span class="fl">32</span>
  , <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>,  <span class="fl">14</span>,  <span class="fl">33</span>
  <span class="op">)</span>

<span class="co"># pre-determined best key variables completion</span>
<span class="va">dat_keys_pre</span> <span class="op">&lt;-</span>
  <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html">tribble</a></span><span class="op">(</span>
    <span class="op">~</span><span class="va">a</span>, <span class="op">~</span><span class="va">b</span>, <span class="op">~</span><span class="va">c</span>, <span class="op">~</span><span class="va">x</span>
  ,  <span class="fl">1</span>, <span class="fl">11</span>, <span class="fl">10</span>, <span class="cn">NA</span>
  ,  <span class="fl">2</span>, <span class="fl">22</span>, <span class="fl">20</span>, <span class="cn">NA</span>
  ,  <span class="fl">3</span>, <span class="fl">33</span>, <span class="cn">NA</span>, <span class="cn">NA</span>
  ,  <span class="fl">4</span>, <span class="cn">NA</span>, <span class="fl">40</span>, <span class="cn">NA</span>
  ,  <span class="fl">5</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>
  ,  <span class="fl">6</span>, <span class="cn">NA</span>, <span class="fl">60</span>, <span class="cn">NA</span>
  , <span class="cn">NA</span>, <span class="fl">77</span>, <span class="cn">NA</span>, <span class="cn">NA</span>
  , <span class="cn">NA</span>, <span class="fl">88</span>, <span class="fl">80</span>, <span class="cn">NA</span>
  , <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>
  <span class="op">)</span></code></pre></div>
</div>
<div id="results" class="section level1">
<h1 class="hasAnchor">
<a href="#results" class="anchor"></a>Results</h1>
<div id="test-key-completion" class="section level2">
<h2 class="hasAnchor">
<a href="#test-key-completion" class="anchor"></a>Test key completion</h2>
<p>Print data.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dat_data</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span>n<span class="op">=</span><span class="cn">Inf</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 14 x 6</span>
<span class="co">#&gt;        a     b     c x        d1    d2</span>
<span class="co">#&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;lgl&gt; &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="co">#&gt;  1     1    11    NA NA        1    20</span>
<span class="co">#&gt;  2     1    NA    10 NA        2    21</span>
<span class="co">#&gt;  3     2    NA    NA NA        3    22</span>
<span class="co">#&gt;  4    NA    22    20 NA        4    23</span>
<span class="co">#&gt;  5     2    NA    20 NA        5    24</span>
<span class="co">#&gt;  6     3    33    NA NA        6    25</span>
<span class="co">#&gt;  7     4    NA    40 NA        7    26</span>
<span class="co">#&gt;  8     5    NA    NA NA        8    27</span>
<span class="co">#&gt;  9     6    NA    60 NA        9    28</span>
<span class="co">#&gt; 10     6    NA    60 NA       10    29</span>
<span class="co">#&gt; 11    NA    77    NA NA       11    30</span>
<span class="co">#&gt; 12    NA    88    80 NA       12    31</span>
<span class="co">#&gt; 13    NA    88    NA NA       13    32</span>
<span class="co">#&gt; 14    NA    NA    NA NA       14    33</span></code></pre></div>
<p>Computing the best key variables completion.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dat_keys</span> <span class="op">&lt;-</span>
  <span class="va">dat_data</span> <span class="op">%&gt;%</span>
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span>
    <span class="va">a</span>, <span class="va">b</span>, <span class="va">c</span>, <span class="va">x</span>
  <span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/e_coalesce_column_set.html">e_coalesce_column_set</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">dat_keys</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span>n<span class="op">=</span><span class="cn">Inf</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 9 x 4</span>
<span class="co">#&gt;       a     b     c x    </span>
<span class="co">#&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;lgl&gt;</span>
<span class="co">#&gt; 1     1    11    10 NA   </span>
<span class="co">#&gt; 2     2    22    20 NA   </span>
<span class="co">#&gt; 3     4    NA    40 NA   </span>
<span class="co">#&gt; 4     6    NA    60 NA   </span>
<span class="co">#&gt; 5    NA    88    80 NA   </span>
<span class="co">#&gt; 6     3    33    NA NA   </span>
<span class="co">#&gt; 7    NA    77    NA NA   </span>
<span class="co">#&gt; 8     5    NA    NA NA   </span>
<span class="co">#&gt; 9    NA    NA    NA NA</span></code></pre></div>
<p>Pre-determined best key variables completion.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dat_keys_pre</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span>n<span class="op">=</span><span class="cn">Inf</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 9 x 4</span>
<span class="co">#&gt;       a     b     c x    </span>
<span class="co">#&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;lgl&gt;</span>
<span class="co">#&gt; 1     1    11    10 NA   </span>
<span class="co">#&gt; 2     2    22    20 NA   </span>
<span class="co">#&gt; 3     3    33    NA NA   </span>
<span class="co">#&gt; 4     4    NA    40 NA   </span>
<span class="co">#&gt; 5     5    NA    NA NA   </span>
<span class="co">#&gt; 6     6    NA    60 NA   </span>
<span class="co">#&gt; 7    NA    77    NA NA   </span>
<span class="co">#&gt; 8    NA    88    80 NA   </span>
<span class="co">#&gt; 9    NA    NA    NA NA</span></code></pre></div>
<p>They are equal.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dat_keys</span>      <span class="op">&lt;-</span> <span class="va">dat_keys</span>     <span class="op">%&gt;%</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="va">a</span>, <span class="va">b</span>, <span class="va">c</span>, <span class="va">x</span><span class="op">)</span>
<span class="va">dat_keys_pre</span>  <span class="op">&lt;-</span> <span class="va">dat_keys_pre</span> <span class="op">%&gt;%</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="va">a</span>, <span class="va">b</span>, <span class="va">c</span>, <span class="va">x</span><span class="op">)</span>

<span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/all_equal.html">all_equal</a></span><span class="op">(</span><span class="va">dat_keys_pre</span>, <span class="va">dat_keys</span><span class="op">)</span>
<span class="co">#&gt; [1] TRUE</span></code></pre></div>
</div>
<div id="best-key-variables-completion-with-data" class="section level2">
<h2 class="hasAnchor">
<a href="#best-key-variables-completion-with-data" class="anchor"></a>Best key variables completion with data</h2>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dat_data_updated</span> <span class="op">&lt;-</span>
  <span class="fu"><a href="../reference/e_complete_multiple_keys.html">e_complete_multiple_keys</a></span><span class="op">(</span>
    <span class="va">dat_data</span>
  , dat_keys <span class="op">=</span> <span class="cn">NULL</span>
  , col_keys <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"c"</span>, <span class="st">"x"</span><span class="op">)</span>
  <span class="op">)</span>

<span class="va">dat_data_updated</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span>n<span class="op">=</span><span class="cn">Inf</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 14 x 6</span>
<span class="co">#&gt;        a     b     c x        d1    d2</span>
<span class="co">#&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;lgl&gt; &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="co">#&gt;  1     1    11    10 NA        1    20</span>
<span class="co">#&gt;  2     1    11    10 NA        2    21</span>
<span class="co">#&gt;  3     2    22    20 NA        3    22</span>
<span class="co">#&gt;  4     2    22    20 NA        4    23</span>
<span class="co">#&gt;  5     2    22    20 NA        5    24</span>
<span class="co">#&gt;  6     3    33    NA NA        6    25</span>
<span class="co">#&gt;  7     4    NA    40 NA        7    26</span>
<span class="co">#&gt;  8     5    NA    NA NA        8    27</span>
<span class="co">#&gt;  9     6    NA    60 NA        9    28</span>
<span class="co">#&gt; 10     6    NA    60 NA       10    29</span>
<span class="co">#&gt; 11    NA    77    NA NA       11    30</span>
<span class="co">#&gt; 12    NA    88    80 NA       12    31</span>
<span class="co">#&gt; 13    NA    88    80 NA       13    32</span>
<span class="co">#&gt; 14    NA    NA    NA NA       14    33</span></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Erik Erhardt.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
